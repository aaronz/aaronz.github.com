<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">

    <title>How Browser Works</title>

    <meta name="description" content="An introduction of browser internal mechanism">
    <meta name="author" content="Aaron Zhang">

    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <link rel="stylesheet" href="css/reveal.min.css">
    <link rel="stylesheet" href="css/theme/serif.css" id="theme">

    <!-- For syntax highlighting -->
    <link rel="stylesheet" href="lib/css/zenburn.css">

    <!-- If the query includes 'print-pdf', include the PDF print sheet -->
    <script>
    if (window.location.search.match(/print-pdf/gi)) {
        var link = document.createElement('link');
        link.rel = 'stylesheet';
        link.type = 'text/css';
        link.href = 'css/print/pdf.css';
        document.getElementsByTagName('head')[0].appendChild(link);
    }
    </script>

    <!--[if lt IE 9]>
        <script src="lib/js/html5shiv.js"></script>
        <![endif]-->
</head>

<body>

    <div class="reveal">

        <!-- Any section element inside of this container is displayed as a slide -->
        <div class="slides">
            <section>
                <h1>How Browser Works</h1>
                <h3>An introduction of browser internal mechanism.</h3>
                <p>
                    <small><a href="http://browserwork.com/contact.html" target="_blank">Aaron Zhang</a> - <a href="http://www.browserwork.com" target="_blank">Browserwork.com</a>
                    </small>
                </p>
            </section>
            <section>
                <h2>Browser Overview</h2>
            </section>
            <section>
                <section>

                    <h2>What is web browser?</h2>
                    <img src="images/internet-explorer.jpg" alt="What is web browser?">
                </section>
                <section>
                    <p>
                        A web browser is a software application for retrieving, presenting and traversing information resources on the World Wide Web. </p>
                </section>
            </section>
            <section>
                <section>
                    <h2>How many browsers are there?</h2>
                    <img src="images/desktop-web-browsers.png" alt="How many browsers are there?">
                </section>
                <section>
                    <ul>
                        <li><a href="http://http://en.wikipedia.org/wiki/WorldWideWeb" title="WorldWideWeb">WorldWideWeb</a>, February 25, 1991</li>
                        <li><a href="http://http://en.wikipedia.org/wiki/Mosaic_(web_browser)" title="Mosaic (web browser)">Mosaic</a>, April 22, 1993</li>
                        <li><a href="http://http://en.wikipedia.org/wiki/Netscape_Navigator" title="Netscape Navigator">Netscape Navigator</a> and <a href="http://http://en.wikipedia.org/wiki/Netscape_Communicator" title="Netscape Communicator">Netscape Communicator</a>, October 13, 1994</li>
                        <li><a href="http://http://en.wikipedia.org/wiki/Internet_Explorer" title="Internet Explorer">Internet Explorer</a>, August 16, 1995</li>
                        <li><a href="http://http://en.wikipedia.org/wiki/Opera_(web_browser)" title="Opera (web browser)">Opera</a>, 1996, see <a href="http://http://en.wikipedia.org/wiki/History_of_the_Opera_web_browser" title="History of the Opera web browser">History of the Opera web browser</a>
                        </li>
                        <li><a href="http://http://en.wikipedia.org/wiki/Mozilla_Application_Suite" title="Mozilla Application Suite">Mozilla Navigator</a>, June 5, 2002<sup id="cite_ref-19" class="reference"><a href="#cite_note-19"><span>[</span>19<span>]</span></a></sup>
                        </li>
                        <li><a href="http://http://en.wikipedia.org/wiki/Safari_(web_browser)" title="Safari (web browser)">Safari</a>, January 7, 2003</li>
                        <li><a href="http://http://en.wikipedia.org/wiki/Mozilla_Firefox" title="Mozilla Firefox" class="mw-redirect">Mozilla Firefox</a>, November 9, 2004</li>
                        <li><a href="http://http://en.wikipedia.org/wiki/Google_Chrome" title="Google Chrome">Google Chrome</a>, September 2, 2008</li>
                    </ul>
                </section>
            </section>
            <section>
                <h2>What is the current web browser market share?</h2>
                <img src="images/browser-market-2014.jpg" alt="browser market 2014">
                <a href="http://www.netmarketshare.com/">http://www.netmarketshare.com/</a>
            </section>
            <section>
                <section>
                    <h2>How does web browser earn money?</h2>
                    <img src="images/dollar.jpg" alt="dollar">
                </section>
                <section>
                    <h3>Sponsored by Search Engine</h3>
                    <img src="images/searchengines.jpg" alt="search engines">
                </section>
            </section>
            <section>
                <section>
                    <h2>What are the common web standards web browsers support?</h2>
                </section>
                <section>
                    <ul>
                        <li><i>Recommendations</i> published by the <a title="World Wide Web Consortium" href="http://en.wikipedia.org/wiki/World_Wide_Web_Consortium">World Wide Web Consortium</a> (W3C)<sup class="reference" id="cite_ref-2"><a href="#cite_note-2"><span>[</span>2<span>]</span></a></sup>
                        </li>
                        <li><i><a title="Internet standard" class="mw-redirect" href="http://en.wikipedia.org/wiki/Internet_standard">Internet standard</a></i> (STD) documents published by the <a title="Internet Engineering Task Force" href="http://en.wikipedia.org/wiki/Internet_Engineering_Task_Force">Internet Engineering Task Force</a> (IETF)</li>
                        <li><i><a title="Request for Comments" href="http://en.wikipedia.org/wiki/Request_for_Comments">Request for Comments</a></i> (RFC) documents published by the Internet Engineering Task Force <sup class="reference" id="cite_ref-3"><a href="#cite_note-3"><span>[</span>3<span>]</span></a></sup>
                        </li>
                        <li><i>Standards</i> published by the <a title="International Organization for Standardization" href="http://en.wikipedia.org/wiki/International_Organization_for_Standardization">International Organization for Standardization</a> (ISO) <sup class="reference" id="cite_ref-4"><a href="#cite_note-4"><span>[</span>4<span>]</span></a></sup>
                        </li>
                        <li><i>Standards</i> published by <a title="Ecma International" href="http://en.wikipedia.org/wiki/Ecma_International">Ecma International</a> (formerly ECMA) <sup class="reference" id="cite_ref-5"><a href="#cite_note-5"><span>[</span>5<span>]</span></a></sup>
                        </li>
                        <li><i>The <a title="Unicode" href="http://en.wikipedia.org/wiki/Unicode">Unicode</a> Standard</i> and various <i>Unicode Technical Reports</i> (UTRs) published by the Unicode Consortium <sup class="reference" id="cite_ref-6"><a href="#cite_note-6"><span>[</span>6<span>]</span></a></sup>
                        </li>
                        <li>Name and number registries maintained by the <a title="Internet Assigned Numbers Authority" href="http://en.wikipedia.org/wiki/Internet_Assigned_Numbers_Authority">Internet Assigned Numbers Authority</a> (IANA) <sup class="reference" id="cite_ref-7"><a href="#cite_note-7"><span>[</span>7<span>]</span></a></sup>
                        </li>
                    </ul>
                </section>

            </section>
            <section>
                <h2>Concepts</h2>
            </section>
            <section>
                <section>
                    <img src="images/browser-major-concepts.png" alt="browser major concepts">
                </section>
                <section>
                    <ul>
                        <li>what is html</li>
                        <li>what is xhtml</li>
                        <li>what is dom</li>
                        <li>what is css</li>
                        <li>what is javascript</li>
                        <li>what is ecmascript</li>
                        <li>what is html5</li>
                    </ul>
                </section>
            </section>
            <section>
                <section>
                    <h3>Do you really know html?</h3>
                    <pre><code>&lt;P&gt;&amp;nbsp;&amp;nbsp;This is not html, it is plain text.&lt;br&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;I said:&lt;br&gt;This is html, not plain text.</code></pre>
                </section>
                <section>
                    <h3>html 4.01</h3>
                    <pre><code>&lt;p&gt;This is not html, it is plain text.&lt;p&gt;
I said:&lt;br&gt;This is html, not plain text.</code></pre>
                </section>
                <section>
                    <h3>xhtml 1.0</h3>
                    <pre><code>&lt;p&gt;This is not html, it is plain text.&lt;/p&gt;&lt;p&gt;
I said:&lt;/br&gt;This is html, not plain text.&lt;/p&gt;</code></pre>
                </section>
                <section>
                    <h3>SEO</h3>
                    <pre>
                        <code>&lt;p&gt; This is not &lt;abbr title="Hyper Text Markup Language"&gt;HTML&lt;/abbr&gt;,it is plain text.&lt;p&gt;
&lt;cite&gt;I&lt;/cite&gt;said:&lt;br&gt; &lt;q&gt;This is html, not plain text.&lt;/q&gt;</code>
                    </pre>
                </section>
            </section>
            <section>
                <section>
                    <h2>Design</h2>
                </section>
                <section>
                    <h3>Common Browser Components</h3>
                    <img src="images/browser-components.png" alt="browser components">
                </section>
                <section>
                    <h3>Internet Explorer Architecture</h3>
                    <img src="images/ie-architecture.png" alt="IE architecture">
                </section>
                <section>
                    <h3>Chrome Architecture</h3>
                    <img src="images/chrome-architecture.png" alt="chrome architecture">
                </section>
            </section>
            <section>
                <h2>Implementation</h2>
            </section>
            <section>
                <h3>Web Page Lifecycle</h3>
                <img src="images/web-page-lifecycle.png" alt="web page lifecycle">
            </section>
            <section>
                <section>
                    <h2>Loading</h2>
                </section>
                <section>
                    <h3>Web Page Hierarchy</h3>
                    <img src="images/web-page-hierarchy.png" alt="web page hierarchy">
                </section>
                <section>
                    <img src="images/javascript-block-rendering.png" alt="javascript block UI rendering">
                </section>
                <section>
                    <h3>Demo</h3>
                    <ul>
                        <li><a href="http://browserwork.com/tests/loadscript/direct-load.html">http://browserwork.com/tests/loadscript/direct-load.html</a>
                        </li>
                        <li><a href="http://browserwork.com/tests/loadscript/document-write.html">http://browserwork.com/tests/loadscript/document-write.html</a>
                        </li>
                        <li><a href="http://browserwork.com/tests/loadscript/defer.html">http://browserwork.com/tests/loadscript/defer.html</a>
                        </li>
                        <li><a href="http://browserwork.com/tests/loadscript/async.html">http://browserwork.com/tests/loadscript/async.html</a>
                        </li>
                        <li><a href="http://browserwork.com/tests/loadscript/dynamic.html">http://browserwork.com/tests/loadscript/dynamic.html</a>
                        </li>
                    </ul>
                </section>
            </section>
            <section>
                <section>
                    <h2>HTML Parsing</h2>
                </section>
                <section>
                    <img src="images/html-parsing.png" alt="html parsing">
                </section>
                <section>
                    <h3>Token Parsing</h3>
                    <img src="images/token-parsing.png" alt="token parsing">
                </section>
                <section>
                    <h3>State Machine</h3>
                    <img src="images/state-machine.png" alt="state machine">
                </section>
                <section>
                    <h3>Tree Construction</h3>
                    <img src="images/dom-tree-construction.png" alt="tree construction">
                </section>
            </section>
            <section>
                <section>
                    <h2>CSS Parsing</h2>
                </section>
                <section>
                    <img src="images/css-parsing.png" alt="css parsing">
                </section>
                <section>
                    <h3>DOM + CSS = Render Tree</h3>
                    <img src="images/dom-and-css.png" alt="dom and css">
                </section>
            </section>
            <section>
                <section>
                    <h2>Reflow and Repaint</h2>
                </section>
                <section>
                    <ul>
                        <li>A repaint occurs when changes are made to an elements skin that changes visibility, but do not affect its layout.
                        </li>
                        <li>A reflow is even more critical to performance because it involves changes that affect the layout of a portion of the page (or the whole page). Reflow of an element causes the subsequent reflow of all child and ancestor elements as well as any elements following it in the DOM.
                        </li>
                    </ul>
                </section>
                <section>
                    <h3>Webkit Render Workflow</h3>
                    <img src="images/webkit-workflow.png" alt="webkit workflow">
                </section>
                <section>
                    <a href="http://v.youku.com/v_show/id_XMzI5MDg0OTA0.html">Gecko Reflow Visualization - Wikipedia</a>
                </section>
                <section>
                    <h3>Performance Guideline</h3>
                    <ul>
                        <li>Reduce unnecessary DOM depth. Changes at one level in the DOM tree can cause changes at every level of the tree - all the way up to the root, and all the the way down into the children of the modified node. This leads to more time being spent performing reflow.
                        </li>
                        <li>Minimize CSS rules, and remove unused CSS rules.
                        </li>
                        <li>If you make complex rendering changes such as animations, do so out of the flow. Use position-absolute or position-fixed to accomplish this.
                        </li>
                        <li>Avoid unnecessary complex CSS selectors - descendant selectors in particular - which require more CPU power to do selector matching.
                        </li>
                    </ul>
                </section>
                <section>
                    <h3>Demo: Internet Explorer F12 UI Responsiveness Tool</h3>
                </section>
            </section>
            <section>
                <section>
                    <h2>JavaScript</h2>
                </section>
                <section>
                    <h3>Firefox JavaScript Engine</h3>
                    <img src="images/firefox-js-engine.png" alt="firefox javascript engine">
                </section>
                <section>
                    <ul>
                        <li><b>Lexer</b> is responsible for the ​lexical analysis, i.e. breaking down the script source into a series of tokens.
                        </li>
                        <li><b>Parser</b> carries out the ​syntactic analysis, i.e. consuming the tokens from the lexer and building the corresponding syntax tree.
                        </li>
                        <li><b>LLInt</b>, short for Low Level Interpreter, executes the bytecodes produced by the parser. The bulk of the Low Level Interpreter is in ​llint/.
                        </li>
                        <li><b>Baseline JIT</b> kicks in for functions that are invoked at least 6 times, or take a loop at least 100 times (or some combination - like 3 invocations with 50 loop iterations total).
                        </li>
                        <li><b>DFG JIT</b> kicks in for functions that are invoked at least 60 times, or that took a loop at least 1000 times.
                        </li>
                        <li><b>FTL JIT</b> kicks in for functions that are invoked thousands of times, or loop tens of thousands of times.
                        </li>
                    </ul>
                </section>
                <section>
                    <img src="images/firefox-javascript-execution.png" alt="firefox javascript execution">
                    <img src="images/firefox-jit-performance.png" alt="firefox jit performance">
                </section>
            </section>
            <section>
                <section>
                    <h2>GC</h2>
                </section>
                <section>
                    <img src="images/walley.png" alt="walley">
                    <p>The basic principles of garbage collection are:</p>
                    <ul>
                        <li>Find data objects in a program that cannot be accessed in the future.</li>
                        <li>Reclaim the resources used by those objects.</li>
                    </ul>
                </section>
                <section>
                    <img src="images/gc-mechanism.png" alt="gc mechanism">
                </section>
                <section>
                    <h3>Mark and Sweep</h3>
                    <img src="images/mark-and-sweep.png" alt="mark and sweep">
                    <ul>
                        <li>When a variable comes into context, such as when a variable is declared inside a function, it is flagged as being in context.
                        </li>
                        <li>When a variable goes out of context, it is also flagged as being out of context.</li>
                    </ul>
                </section>
                <section>
                    <h3>Reference Counting</h3>
                    <img src="images/reference-counting.png" alt="reference-counting">
                </section>
            </section>
            <section>
                <section>
                    <h2>Memory Leak</h2>
                </section>
                <section>
                    <h3>Memory Leak Patterns</h3>
                    <img src="images/circular-reference-basic.png" alt="circular reference basic">
                </section>
                <section>
                    <img src="images/circular-reference-closure.png" alt="circular reference closure">
                    <br>
                    <a href="http://msdn.microsoft.com/en-us/library/bb250448(v=vs.85).aspx">http://msdn.microsoft.com/en-us/library/bb250448(v=vs.85).aspx</a>
                </section>
                <section>
                    <h3>Demo: IE memory leak</h3>
                    <ul>
                        <li><a href="http://browserwork.com/tests/leak-test1.html">http://browserwork.com/tests/leak-test1.html</a>
                        </li>
                        <li><a href="http://browserwork.com/tests/leak-test2.html">http://browserwork.com/tests/leak-test2.html</a>
                        </li>
                        <li><a href="http://browserwork.com/tests/leak-test3.html">http://browserwork.com/tests/leak-test3.html</a>
                        </li>
                    </ul>
                </section>
            </section>
            <section>
                <h2>THE END</h2>
                <p>BY <a href="http://browserwork.com/contact.html" target="_blank">Aaron Zhang</a> / <a href="http://browserwork.com">browserwork.com</a>
                </p>
            </section>

        </div>

    </div>

    <script src="lib/js/head.min.js"></script>
    <script src="js/reveal.min.js"></script>

    <script>
    // Full list of configuration options available here:
    // https://github.com/hakimel/reveal.js#configuration
    Reveal.initialize({
        controls: true,
        progress: true,
        history: true,
        center: true,

        theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
        transition: Reveal.getQueryHash().transition || 'default', // default/cube/page/concave/zoom/linear/fade/none

        // Parallax scrolling
        // parallaxBackgroundImage: 'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg',
        // parallaxBackgroundSize: '2100px 900px',

        // Optional libraries used to extend on reveal.js
        dependencies: [{
            src: 'lib/js/classList.js',
            condition: function() {
                return !document.body.classList;
            }
        }, {
            src: 'plugin/markdown/marked.js',
            condition: function() {
                return !!document.querySelector('[data-markdown]');
            }
        }, {
            src: 'plugin/markdown/markdown.js',
            condition: function() {
                return !!document.querySelector('[data-markdown]');
            }
        }, {
            src: 'plugin/highlight/highlight.js',
            async: true,
            callback: function() {
                hljs.initHighlightingOnLoad();
            }
        }, {
            src: 'plugin/zoom-js/zoom.js',
            async: true,
            condition: function() {
                return !!document.body.classList;
            }
        }, {
            src: 'plugin/notes/notes.js',
            async: true,
            condition: function() {
                return !!document.body.classList;
            }
        }]
    });
    </script>

</body>

</html>
