---
layout: slide 
title: How Browser Works
description:  An introduction of browser internal mechanism
links:
- http://taligarsiel.com/Projects/howbrowserswork1.htm
---

<section>
    <h2>Browser Overview</h2>
</section>
<section>
    <section>

        <h2>What is web browser?</h2>
        <div class="fragment">
            <blockquote>A web browser is a software application for retrieving, presenting and traversing information resources on the World Wide Web. </blockquote>
            <a href="http://en.wikipedia.org/wiki/Web_browser">http://en.wikipedia.org/wiki/Web_browser</a>
        </div>
    </section>
    <section>
        <h2>What web browser can do TODAY?</h2>
        <ul>
            <li class="fragment"><a href="https://onedrive.live.com/">Office Online</a>
            </li>
            <li class="fragment"><a href="https://www.visualstudio.com/">Coding Online</a>
            </li>
            <li class="fragment"><a href="https://developers.google.com/chart/interactive/docs/gallery">Professional Charts</a>
            </li>
            <li class="fragment"><a href="http://greensock.com/examples-showcases">Great Animations</a>
            </li>
            <li class="fragment"><a href="http://www.fishgl.com/">3D Drawing</a>
            </li>
            <li class="fragment"><a href="http://html5demos.com/">Much more...</a>
            </li>
        </ul>
    </section>
</section>
<section>
    <section>
        <h2>How many browsers are there?</h2>
        <img src="images/desktop-web-browsers.png" alt="How many browsers are there?">
    </section>
    <section>
        <ul>
            <li><a href="http://http://en.wikipedia.org/wiki/WorldWideWeb" title="WorldWideWeb">WorldWideWeb</a>, February 25, 1991</li>
            <li><a href="http://http://en.wikipedia.org/wiki/Mosaic_(web_browser)" title="Mosaic (web browser)">Mosaic</a>, April 22, 1993</li>
            <li><a href="http://http://en.wikipedia.org/wiki/Netscape_Navigator" title="Netscape Navigator">Netscape Navigator</a> and <a href="http://http://en.wikipedia.org/wiki/Netscape_Communicator" title="Netscape Communicator">Netscape Communicator</a>, October 13, 1994</li>
            <li><a href="http://http://en.wikipedia.org/wiki/Internet_Explorer" title="Internet Explorer">Internet Explorer</a>, August 16, 1995</li>
            <li><a href="http://http://en.wikipedia.org/wiki/Opera_(web_browser)" title="Opera (web browser)">Opera</a>, 1996, see <a href="http://http://en.wikipedia.org/wiki/History_of_the_Opera_web_browser" title="History of the Opera web browser">History of the Opera web browser</a>
            </li>
            <li><a href="http://http://en.wikipedia.org/wiki/Mozilla_Application_Suite" title="Mozilla Application Suite">Mozilla Navigator</a>, June 5, 2002<sup id="cite_ref-19" class="reference"><a href="#cite_note-19"><span>[</span>19<span>]</span></a></sup>
            </li>
            <li><a href="http://http://en.wikipedia.org/wiki/Safari_(web_browser)" title="Safari (web browser)">Safari</a>, January 7, 2003</li>
            <li><a href="http://http://en.wikipedia.org/wiki/Mozilla_Firefox" title="Mozilla Firefox" class="mw-redirect">Mozilla Firefox</a>, November 9, 2004</li>
            <li><a href="http://http://en.wikipedia.org/wiki/Google_Chrome" title="Google Chrome">Google Chrome</a>, September 2, 2008</li>
        </ul>
    </section>
</section>
<section>
    <section>
        <h2>What is the current web browser market share?</h2>
        <img src="images/browser-market-2014.jpg" alt="browser market 2014">
        <a href="http://www.netmarketshare.com/">http://www.netmarketshare.com/</a>
    </section>
</section>
<section>
    <section>
        <h2>How does web browser earn money?</h2>
        <img src="images/dollar.jpg" alt="dollar">
    </section>
    <section>
        <ul>
            <li>For browser-focused organizations, the browser can generate revenue directly. The most common strategy for this is search partnership.</li>
            <li>For bigger organizations, developing a browser can often have a strategic value.
                <img src="images/microsoft-apple-google.jpg" alt="microsoft apple google">
            </li>

        </ul>
    </section>
</section>
<section>
    <section>
        <h2>What are the common web standards web browsers support?</h2>
    </section>
    <section>
        <ul>
            <li><i>Recommendations</i> published by the <a title="World Wide Web Consortium" href="http://en.wikipedia.org/wiki/World_Wide_Web_Consortium">World Wide Web Consortium</a> (W3C)<sup class="reference" id="cite_ref-2"><a href="#cite_note-2"><span>[</span>2<span>]</span></a></sup>
            </li>
            <li><i><a title="Internet standard" class="mw-redirect" href="http://en.wikipedia.org/wiki/Internet_standard">Internet standard</a></i> (STD) documents published by the <a title="Internet Engineering Task Force" href="http://en.wikipedia.org/wiki/Internet_Engineering_Task_Force">Internet Engineering Task Force</a> (IETF)</li>
            <li><i><a title="Request for Comments" href="http://en.wikipedia.org/wiki/Request_for_Comments">Request for Comments</a></i> (RFC) documents published by the Internet Engineering Task Force <sup class="reference" id="cite_ref-3"><a href="#cite_note-3"><span>[</span>3<span>]</span></a></sup>
            </li>
            <li><i>Standards</i> published by the <a title="International Organization for Standardization" href="http://en.wikipedia.org/wiki/International_Organization_for_Standardization">International Organization for Standardization</a> (ISO) <sup class="reference" id="cite_ref-4"><a href="#cite_note-4"><span>[</span>4<span>]</span></a></sup>
            </li>
            <li><i>Standards</i> published by <a title="Ecma International" href="http://en.wikipedia.org/wiki/Ecma_International">Ecma International</a> (formerly ECMA) <sup class="reference" id="cite_ref-5"><a href="#cite_note-5"><span>[</span>5<span>]</span></a></sup>
            </li>
            <li><i>The <a title="Unicode" href="http://en.wikipedia.org/wiki/Unicode">Unicode</a> Standard</i> and various <i>Unicode Technical Reports</i> (UTRs) published by the Unicode Consortium <sup class="reference" id="cite_ref-6"><a href="#cite_note-6"><span>[</span>6<span>]</span></a></sup>
            </li>
            <li>Name and number registries maintained by the <a title="Internet Assigned Numbers Authority" href="http://en.wikipedia.org/wiki/Internet_Assigned_Numbers_Authority">Internet Assigned Numbers Authority</a> (IANA) <sup class="reference" id="cite_ref-7"><a href="#cite_note-7"><span>[</span>7<span>]</span></a></sup>
            </li>
        </ul>
    </section>

</section>
<section>
    <section>
        <h2>Concepts</h2>
    </section>
    <section>
        <h3>HTTP</h3>
        <p>The Hypertext Transfer Protocol (HTTP) is an application protocol for distributed, collaborative, hypermedia information systems.[1] HTTP is the foundation of data communication for the World Wide Web.</p>
        <pre><code>GET /index.html HTTP/1.1
Host: www.example.com</code></pre>
        <pre><code>HTTP/1.1 200 OK
Date: Mon, 23 May 2005 22:38:34 GMT
Server: Apache/1.3.3.7 (Unix) (Red-Hat/Linux)
Last-Modified: Wed, 08 Jan 2003 23:11:55 GMT
ETag: "3f80f-1b6-3e1cb03b"
Content-Type: text/html; charset=UTF-8
Content-Length: 131
Accept-Ranges: bytes
Connection: close
</code></pre>
        <a href="http://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol">http://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol</a>
    </section>
    <section>
        <h3>HTML</h3>

        <p><b>HTML</b> or <b>HyperText Markup Language</b> is the standard <a href="http://en.wikipedia.org/wiki/Markup_language" title="Markup language">markup language</a> used to create <a href="http://en.wikipedia.org/wiki/Web_page" title="Web page">Web pages</a>.</p>
        <p>HTML is written in the form of <a href="http://en.wikipedia.org/wiki/HTML_element" title="HTML element">HTML elements</a> consisting of <i>tags</i> enclosed in <a href="http://en.wikipedia.org/wiki/Bracket#Angle_brackets" title="Bracket">angle brackets</a> (like <code>&lt;html&gt;</code>). HTML tags most commonly come in pairs like <code class="nowrap" style="">&lt;h1&gt;</code> and <code class="nowrap" style="">&lt;/h1&gt;</code>, although some tags represent <i>empty elements</i> and so are unpaired, for example <code>&lt;img&gt;</code>. The first tag in a pair is the <i>start tag</i>, and the second tag is the <i>end tag</i> (they are also called <i>opening tags</i> and <i>closing tags</i>).</p>
        <a href="http://en.wikipedia.org/wiki/HTML">http://en.wikipedia.org/wiki/HTML</a>
    </section>
    <section>

        <h3>Do you really know html?</h3>
        <pre><code>&lt;P&gt;&amp;nbsp;&amp;nbsp;This is not html, it is plain text.&lt;br&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;I said:&lt;br&gt;This is html, not plain text.</code></pre>

        <div class="fragment">

            <h3>html 4.01</h3>
            <pre><code>&lt;p&gt;This is not html, it is plain text.&lt;p&gt;
I said:&lt;br&gt;This is html, not plain text.</code></pre>
        </div>

        <div class="fragment">

            <h3>xhtml 1.0</h3>
            <pre><code>&lt;p&gt;This is not html, it is plain text.&lt;/p&gt;&lt;p&gt;
I said:&lt;/br&gt;This is html, not plain text.&lt;/p&gt;</code></pre>
        </div>
        <div class="fragment">

            <h3>SEO</h3>
            <pre>
                        <code>&lt;p&gt; This is not &lt;abbr title="Hyper Text Markup Language"&gt;HTML&lt;/abbr&gt;,it is plain text.&lt;p&gt;
&lt;cite&gt;I&lt;/cite&gt;said:&lt;br&gt; &lt;q&gt;This is html, not plain text.&lt;/q&gt;</code>
                    </pre>
        </div>
    </section>
    <section>
        <h3>DOM</h3>
        <p>The Document Object Model (DOM) is a cross-platform and language-independent convention for representing and interacting with objects in HTML, XHTML, and XML documents. The nodes of every document are organized in a tree structure, called the DOM tree.</p>
        <img src="images/document-object-model.png" alt="DOM">
        <a href="http://en.wikipedia.org/wiki/Document_Object_Model">http://en.wikipedia.org/wiki/Document_Object_Model</a>
    </section>
    <section>
        <h3>CSS</h3>
        <p>Cascading Style Sheets (CSS) is a style sheet language used for describing the look and formatting of a document written in a markup language. </p>
        <img src="images/css3.png" alt="css3">
        <a href="http://en.wikipedia.org/wiki/Cascading_Style_Sheets">http://en.wikipedia.org/wiki/Cascading_Style_Sheets</a>
    </section>
    <section>
        <h3>HTML5</h3>
        <p>HTML5 is a core technology markup language of the Internet used for structuring and presenting content for the World Wide Web.</p>

        <img src="images/html5.png" alt="HTML">
        <p><a href="http://en.wikipedia.org/wiki/HTML5">http://en.wikipedia.org/wiki/HTML5</a>
        </p>
        <p><a href="http://slides.html5rocks.com/">HTML Introduction</a>
        </p>
    </section>
    <section>
        <h3>JavaScript</h3>
        <p>JavaScript (/ˈdʒɑːvəˌskrɪpt/; JS) is a dynamic computer programming language. </p>
        <ul>
            <li>It is most commonly used as part of web browsers, whose implementations allow client-side scripts to interact with the user, control the browser, communicate asynchronously, and alter the document content that is displayed.</li>
            <li>It is also used in server-side network programming with runtime environments such as Node.js, game development and the creation of desktop and mobile applications.</li>
        </ul>
        <a href="http://en.wikipedia.org/wiki/JavaScript">http://en.wikipedia.org/wiki/JavaScript</a>
    </section>
    <section>
        <h3>EcmaScript</h3>
        <p>ECMAScript is the scripting language standardized by Ecma International in the ECMA-262 specification and ISO/IEC 16262. The language is widely used for client-side scripting on the web, in the form of several well-known implementations such as JavaScript, JScript and ActionScript.</p>
        <a href="http://en.wikipedia.org/wiki/ECMAScript">http://en.wikipedia.org/wiki/ECMAScript</a>
    </section>
</section>

<section>
    <section>
        <h2>Design</h2>
    </section>
    <section>
        <h3>Web Browser Architecture</h3>
        <img src="images/browser-components.png" alt="browser components">
    </section>
    <section>
        <h3>User Interface</h3>
        <ul>
            <li>Address bar</li>
            <li>Back/forward button</li>
            <li>Bookmark menu</li>
        </ul>
    </section>
    <section>
        <h3>Render Engines</h3>
        <ul>
            <li>Gecko (Firefox)</li>
            <li>Presto (Opera)</li>
            <li>Trident (MSIE)</li>
            <li>WebKit (Chrome, Safari, iOS)</li>
        </ul>
    </section>
    <section>
        <h3>JavaScript Interpreter</h3>
        <ul>
            <li>Carakan (Opera)</li>
            <li>Chakra (Microsoft)</li>
            <li>Nitro, JavaScriptCore (Apple)</li>
            <li>SpiderMonkey, IonMonkey, Rhino (Mozilla)</li>
            <li>V8 (Google)</li>
        </ul>
    </section>
    <section>
        <h3>Browser Engine</h3>
        <ul>
            <li>Process Management (security, communication...)</li>
            <li>Plugin</li>
            <li>Extensions</li>
            <li>Addons</li>
        </ul>
    </section>
    <section>
        <h3>Display Backend</h3>
        <ul>
            <li>Windows</li>
            <li>Radio buttons</li>
            <li>Text Controls</li>
        </ul>
    </section>
    <section>
        <h3>Data Persistent</h3>
        <ul>
            <li>Cache</li>
            <li>Cookie</li>
            <li>LocalStorage</li>
        </ul>
    </section>
    <section>
        <h3>Network</h3>
        <ul>
            <li>Http</li>
            <li>Https</li>
            <li>SPDY</li>
        </ul>
    </section>
</section>
<section>
    <h3>Web Page Lifecycle</h3>
    <img src="images/web-page-lifecycle.png" alt="web page lifecycle">
</section>
<section>
    <section>
        <h2>HTML Parsing</h2>
    </section>
    <section>
        <h2 id="document-object-model-dom">Document Object Model (DOM)</h2>
        <pre><code>    &lt;html&gt;
      &lt;head&gt;
        &lt;meta name="viewport" content="width=device-width,initial-scale=1"&gt;
        &lt;link href="style.css" rel="stylesheet"&gt;
        &lt;title&gt;Critical Path&lt;/title&gt;
      &lt;/head&gt;
      &lt;body&gt;
        &lt;p&gt;Hello &lt;span&gt;web performance&lt;/span&gt; students!&lt;/p&gt;
        &lt;div&gt;&lt;img src="awesome-photo.jpg"&gt;&lt;/div&gt;
      &lt;/body&gt;
    &lt;/html&gt;</code></pre>
        <a class="highlight-module__cta button--primary" href="http://googlesamples.github.io/web-fundamentals/samples/performance/critical-rendering-path/basic_dom.html">Try full sample</a>
        <p>Let’s start, with the simplest possible case: a plain HTML page with some text and a single image. What does the browser need to do to process this simple page?</p>
    </section>
    <section>
        <p><img alt="DOM construction process" src="images/full-process.png" />
        </p>
    </section>
    <section>
        <ol>
            <li><strong>Conversion:</strong> the browser reads the raw bytes of the HTML off the disk or network and translates them to individual characters based on specified encoding of the file (e.g. UTF-8).</li>
            <li><strong>Tokenizing:</strong> the browser converts strings of characters into distinct tokens specified by the <a href="http://www.w3.org/TR/html5/">W3C HTML5 standard</a> - e.g. “&lt;html&gt;”, “&lt;body&gt;” and other strings within the “angle brackets”. Each token has a special meaning and a set of rules.</li>
            <li><strong>Lexing:</strong> the emitted tokens are converted into “objects” which define their properties and rules.</li>
            <li><strong>DOM construction:</strong> Finally, because the HTML markup defines relationships between different tags (some tags are contained within tags) the created objects are linked in a tree data structure that also captures the parent-child relationships defined in the original markup: <em>HTML</em> object is a parent of the <em>body</em> object, the <em>body</em> is a parent of the <em>paragraph</em> object, and so on.</li>
        </ol>
    </section>
    <section>
        <p><img alt="DOM tree" src="images/dom-tree.png" />
        </p>
        <p><strong>The final output of this entire process is the Document Object Model, or the "DOM" of our simple page, which the browser uses for all further processing of the page.</strong>
        </p>
    </section>
</section>
<section>
    <section>
        <h2>CSS Parsing</h2>
    </section>
    <section>
        <img src="images/cssom-construction.png" alt="cssom construction">
    </section>
    <section>
        <pre><code>body { font-size: 16px }
p { font-weight: bold }
span { color: red }
p span { display: none }
img { float: right }</code></pre>
        <img src="images/cssom-tree.png" alt="css parsing">
    </section>
    <section>
        <h3>DOM + CSS = Render Tree</h3>
        <img src="images/render-tree-construction.png" alt="dom and css">
    </section>
</section>
<section>
    <section>
        <h2>Reflow and Repaint</h2>
    </section>
    <section>
        <ul>
            <li>A repaint occurs when changes are made to an elements skin that changes visibility, but do not affect its layout.
            </li>
            <li>A reflow is even more critical to performance because it involves changes that affect the layout of a portion of the page (or the whole page). Reflow of an element causes the subsequent reflow of all child and ancestor elements as well as any elements following it in the DOM.
            </li>
        </ul>
    </section>
    <section>
        <h3>Webkit Render Workflow</h3>
        <img src="images/webkit-workflow.png" alt="webkit workflow">
    </section>
    <section>
        <a href="http://v.youku.com/v_show/id_XMzI5MDg0OTA0.html">Gecko Reflow Visualization - Wikipedia</a>
    </section>
    <section>
        <h3>Performance Guideline</h3>
        <ul>
            <li>Reduce unnecessary DOM depth. Changes at one level in the DOM tree can cause changes at every level of the tree - all the way up to the root, and all the the way down into the children of the modified node. This leads to more time being spent performing reflow.
            </li>
            <li>Minimize CSS rules, and remove unused CSS rules.
            </li>
            <li>If you make complex rendering changes such as animations, do so out of the flow. Use position-absolute or position-fixed to accomplish this.
            </li>
            <li>Avoid unnecessary complex CSS selectors - descendant selectors in particular - which require more CPU power to do selector matching.
            </li>
        </ul>
    </section>
    <section>
        <h3>Demo: Internet Explorer F12 UI Responsiveness Tool</h3>
    </section>
</section>
<section>
    <section>
        <h2>JavaScript</h2>
    </section>
    <section>
        <h3>Firefox JavaScript Engine</h3>
        <img src="images/firefox-js-engine.png" alt="firefox javascript engine">
    </section>
    <section>
        <ul>
            <li><b>Lexer</b> is responsible for the ​lexical analysis, i.e. breaking down the script source into a series of tokens.
            </li>
            <li><b>Parser</b> carries out the ​syntactic analysis, i.e. consuming the tokens from the lexer and building the corresponding syntax tree.
            </li>
            <li><b>LLInt</b>, short for Low Level Interpreter, executes the bytecodes produced by the parser. The bulk of the Low Level Interpreter is in ​llint/.
            </li>
            <li><b>Baseline JIT</b> kicks in for functions that are invoked at least 6 times, or take a loop at least 100 times (or some combination - like 3 invocations with 50 loop iterations total).
            </li>
            <li><b>DFG JIT</b> kicks in for functions that are invoked at least 60 times, or that took a loop at least 1000 times.
            </li>
            <li><b>FTL JIT</b> kicks in for functions that are invoked thousands of times, or loop tens of thousands of times.
            </li>
        </ul>
    </section>
    <section>
        <img src="images/firefox-javascript-execution.png" alt="firefox javascript execution">
        <img src="images/firefox-jit-performance.png" alt="firefox jit performance">
    </section>
</section>
<section>
    <section>
        <h2>GC</h2>
    </section>
    <section>
        <img src="images/walley.png" alt="walley">
        <p>The basic principles of garbage collection are:</p>
        <ul>
            <li>Find data objects in a program that cannot be accessed in the future.</li>
            <li>Reclaim the resources used by those objects.</li>
        </ul>
    </section>
    <section>
        <img src="images/gc-mechanism.png" alt="gc mechanism">
    </section>
    <section>
        <h3>Mark and Sweep</h3>
        <img src="images/mark-and-sweep.png" alt="mark and sweep">
        <ul>
            <li>When a variable comes into context, such as when a variable is declared inside a function, it is flagged as being in context.
            </li>
            <li>When a variable goes out of context, it is also flagged as being out of context.</li>
        </ul>
    </section>
    <section>
        <h3>Reference Counting</h3>
        <img src="images/reference-counting.png" alt="reference-counting">
    </section>
</section>

